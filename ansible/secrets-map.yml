---
# Logical secrets mapping for Azure Key Vault â†’ device env files
# Extend by adding new top-level keys with hosts/groups, env_file, and secrets map

litellm:
  hosts: ["motoko"]
  vault: "kv-miket-ops"
  env_file: "/opt/litellm/.env"
  owner: "root"
  group: "root"
  mode: "0600"
  become_user: "mdt"
  restart_services:
    - "litellm"
  secrets:
    OPENAI_API_KEY: "openai-api-key"
    LITELLM_TOKEN: "litellm-bearer-token"

data_lifecycle:
  hosts: ["motoko"]
  vault: "kv-miket-ops"
  env_file: "/etc/miket/storage-credentials.env"
  owner: "root"
  group: "root"
  mode: "0600"
  become_user: "mdt"
  restart_services:
    - "flux-backup.service"
    - "space-mirror.service"
  secrets:
    B2_APPLICATION_KEY_ID: "b2-space-mirror-id"
    B2_APPLICATION_KEY: "b2-space-mirror-key"
    B2_ACCOUNT_ID: "b2-restic-id"
    B2_ACCOUNT_KEY: "b2-restic-key"
    RESTIC_PASSWORD: "restic-password"

mount_shares_macos:
  groups: ["macos"]
  vault: "kv-miket-ops"
  env_file: "~/.mkt/mounts.env"
  owner: "{{ ansible_user | default('miket') }}"
  group: "{{ ansible_user | default('miket') }}"
  mode: "0600"
  become: false
  secrets:
    SMB_PASSWORD: "motoko-smb-password"
