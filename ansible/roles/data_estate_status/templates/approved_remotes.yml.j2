# Approved Cloud Remotes Registry
# Generated by Ansible from miket-infra-devices data_estate_status role
# Source: miket-infra approved_remotes.yml
#
# Any rclone remote NOT in this list triggers a CRITICAL alert.
# This is a security control to detect unauthorized cloud storage usage.

---
# Approved rclone remotes
approved_rclone_remotes:
{% for remote in data_estate_approved_remotes %}
  - name: {{ remote.name }}
    type: {{ remote.type }}
{% if remote.bucket is defined %}
    bucket: {{ remote.bucket }}
{% endif %}
    purpose: "{{ remote.purpose }}"
{% endfor %}

# Validation rules
validation:
  # Unknown remotes trigger CRITICAL status
  unknown_remote_severity: critical
  
  # Patterns to always flag as suspicious (even if manually approved)
  prohibited_patterns:
    - "dropbox"
    - "gdrive"
    - "google"
    - "icloud"
    - "pcloud"
  
  # Allow local filesystem remotes (used for testing)
  allow_local_remotes: false

