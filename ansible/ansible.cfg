# Ansible configuration for miket-infra-devices
# Provides better observability and performance for Windows deployments

[defaults]
# Use the inventory file
inventory = inventory/hosts.yml

# Use the vault password file if it exists, otherwise prompt
# Priority: age-encrypted (SSH keys) > Azure Key Vault > 1Password > Local file
# Age encryption is most automation-friendly - no external services or logins needed
vault_password_file = /home/mdt/miket-infra-devices/scripts/ansible-vault-password.sh

# Enable callback plugins for better output
stdout_callback = yaml
# Use 'minimal' for less verbose output, 'yaml' for structured output
# Use 'default' for standard output

# Display skipped tasks (useful for debugging)
display_skipped_hosts = True
display_ok_hosts = True

# Show task timing
show_task_path_on_failure = True

# Retry settings
retry_files_enabled = False

# Host key checking (disabled for Tailscale network)
host_key_checking = False

# Timeout settings
timeout = 600
command_timeout = 600

# Performance optimizations
gathering = smart
fact_caching = jsonfile
fact_caching_connection = /tmp/ansible_facts
fact_caching_timeout = 3600

# WinRM specific settings (applied globally, can be overridden in inventory)
[winrm]
# These are defaults, but group_vars/windows/main.yml takes precedence
read_timeout = 600
operation_timeout = 600
connection_timeout = 60

# Logging
[logging]
# Enable logging for troubleshooting
log_path = /tmp/ansible.log

