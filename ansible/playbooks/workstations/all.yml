# Copyright (c) 2025 MikeT LLC. All rights reserved.

---
# =============================================================================
# ALL WORKSTATIONS PLAYBOOK
# =============================================================================
#
# Master playbook for configuring ALL workstations across platforms:
# - Linux workstations
# - Windows workstations
# - macOS workstations
#
# USAGE:
#   Full deployment (all workstations):
#     ansible-playbook -i inventory/hosts.yml playbooks/workstations/all.yml
#
#   Dev tools only:
#     ansible-playbook -i inventory/hosts.yml playbooks/workstations/all.yml --tags dev_tools
#
#   GUI tools only:
#     ansible-playbook -i inventory/hosts.yml playbooks/workstations/all.yml --tags workstation_gui
#
# =============================================================================

- name: Configure All Workstations
  hosts: all_workstations
  gather_facts: true

  pre_tasks:
    - name: Display deployment banner
      ansible.builtin.debug:
        msg: |
          ═══════════════════════════════════════════════════════════════
          ALL WORKSTATIONS DEPLOYMENT
          ═══════════════════════════════════════════════════════════════
          
          Host:       {{ inventory_hostname }}
          OS Family:  {{ ansible_os_family }}
          
          Deployment Phases:
            1. common_dev_tools      - Baseline dev tooling (git, gh, jq, etc.)
            2. workstation_gui_tools - GUI apps (Cursor, Warp, VS Code)
          
          ═══════════════════════════════════════════════════════════════
      tags: [always]

    # Set become based on OS
    - name: Set become for Linux/Windows
      ansible.builtin.set_fact:
        ansible_become: true
      when: ansible_os_family != 'Darwin'
      tags: [always]

    - name: Set no become for macOS
      ansible.builtin.set_fact:
        ansible_become: false
      when: ansible_os_family == 'Darwin'
      tags: [always]

  roles:
    # ========================================
    # Common Dev Tools
    # ========================================
    - role: common_dev_tools
      tags: [dev_tools]

    # ========================================
    # Workstation GUI Tools
    # ========================================
    - role: workstation_gui_tools
      tags: [workstation_gui]

  post_tasks:
    - name: Display completion summary
      ansible.builtin.debug:
        msg: |
          ═══════════════════════════════════════════════════════════════
          WORKSTATION DEPLOYMENT COMPLETE
          ═══════════════════════════════════════════════════════════════
          
          Host: {{ inventory_hostname }}
          OS:   {{ ansible_os_family }}
          
          ✅ Dev Tools installed
          ✅ GUI Tools installed (Cursor, Warp, VS Code)
          
          ═══════════════════════════════════════════════════════════════
      tags: [always]





